<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./template/staffMasterPage.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="center">


        <h:outputScript library = "js" name = "help.js"   />

        <h:outputStylesheet library="css" name="test.css"/>

        <p style="color:orange; font-size:1.3em;"> 
            DASHBOARD PAGE </p>

        <h:form id="dashboardParentForm">

            <p:tabView id="dashboardTab" dynamic="true" cache="true" effect="fold">


                <p:tab title="Overview">

                    <div style="margin-top: 25px;">
                        <h:form id="selectDateForm">
                            <p:growl id="msgs" showDetail="true" />
                            <h:panelGrid columns="5" cellpadding="5">
                                <p:outputLabel style="color:white;" for="fromDate" value="From" />
                                <p:calendar id="fromDate" value="#{dashboardManagedBean.salesDate}"  maxdate="#{dashboardManagedBean.currentDate}" />
                                <p:outputLabel style="color:white;" for="toDate" value="To" />
                                <p:calendar id="toDate"  value="#{dashboardManagedBean.salesDate}"  maxdate="#{dashboardManagedBean.currentDate}" />
                                <p:commandButton  update="msgs" actionListener="#{dashboardManagedBean.click}" icon="ui-icon-search" />
                            </h:panelGrid>

                        </h:form>

                    </div>

                    <div style="height:100%; margin-top: 25px;">
                        <h:form>
                            <p:growl id="msgs" showDetail="true" />

                            <p:outputPanel id="restrictPanel" layout="block" style="width:99%;height:500px;border:0px solid #666666;margin-bottom:20px">


                                <p:panel  id="barchartToggle" header="Product Sales" toggleable="true"  toggleSpeed="500" closeSpeed="500" widgetVar="panel" style="margin-bottom:20px;border-color: white !important;">

                                    <br/>
                                    <h:panelGrid >
                                        <!--                            <h:outputText style="color:white" value="Products Sales August - December" />-->

                                        <div >
                                            <p:chart type="line"  model="#{dashboardManagedBean.salesLineChart}" responsive="true" style="height:350px; width:1200px"/>

                                        </div>

                                    </h:panelGrid>
                                </p:panel>


                                <p:panel id="pnl" header="Sales by Country" style="border-color:lightgrey !important; " toggleable="true"  toggleSpeed="500" closeSpeed="500" >

                                        <div> 
                                            <h:panelGrid columns="2" cellpadding="5">
                                                <p:outputLabel for="country" style="color:white;" value="Country: " />
                                                <p:selectOneMenu id="country" value="haha" style="width:150px">
            <!--                                        <p:ajax listener="#{dropdownView.onCountryChange}" update="city" />
                                                    <f:selectItem itemLabel="Select Country" itemValue="" noSelectionOption="true" />-->
                                                    <f:selectItems value="#{dashboardManagedBean.totalSalesByTeamFilter}" />
                                                </p:selectOneMenu>
                                            </h:panelGrid>
                                        </div>

                                        <div style="margin-top:15px">
                                            <p:chart id="votes" type="pie" model="#{dashboardManagedBean.livePieModel}" style="width:575px; height:350px"/>
                                        </div>


                                    </p:panel>

                                    <p:panel id="pn2" header="View Products Rating" style="border-color:lightgrey !important;" toggleable="true"  toggleSpeed="500" closeSpeed="500">

                                        <div> 
                                            <h:panelGrid columns="2" cellpadding="5">
                                                <p:outputLabel for="countTest" style="color:white;" value="Country: " />
                                                <p:selectOneMenu id="countTest" value="haha" style="width:150px">
            <!--                                        <p:ajax listener="#{dropdownView.onCountryChange}" update="city" />
                                                    <f:selectItem itemLabel="Select Country" itemValue="" noSelectionOption="true" />-->
                                                    <f:selectItems value="#{dashboardManagedBean.totalSalesByTeamFilter}" />
                                                </p:selectOneMenu>
                                            </h:panelGrid>
                                        </div>

                                        <div style="margin-top:15px">
                                            <p:chart type="bar" model="#{dashboardManagedBean.horizontalRating}" style="width:575px; height:350px"/>
                                        </div>

                                    </p:panel>


                               
                                <br/>

                                <p:panel  id="test" header="Testing" toggleable="true"  toggleSpeed="500" closeSpeed="500" widgetVar="panel" style="margin-bottom:20px;border-color: white !important;">

                                    <br/>
                                    <h:panelGrid >
                                        <!--                            <h:outputText style="color:white" value="Products Sales August - December" />-->

                                        <div >
                                            <p:chart type="line"  model="#{dashboardManagedBean.salesLineChart}" responsive="true" style="height:350px; width:1200px"/>

                                        </div>

                                    </h:panelGrid>
                                </p:panel>


                            </p:outputPanel>


                            <p:draggable for="pnl" grid="20 , 40" containment="parent"  opacity ="0.3" />
                            <p:draggable for="pn2" grid="20 , 40" containment="parent"  opacity="0.3" />



                            <p:draggable for="barchartToggle"   containment="parent" />
                        </h:form>

                    </div>


                </p:tab>

                <p:tab title="Customer and Product Report">

                    <!--                    <p:growl id="msgGrow" showDetail="true" />-->

                    <div style="margin-top: 25px;">
                        <h:form id="selectDateFormTopSales">
                            <p:growl id="msgsTopSales" showDetail="true" />
                            <h:panelGrid columns="5" cellpadding="5">
                                <p:outputLabel style="color:white;" for="fromDateTop" value="From" />
                                <p:calendar id="fromDateTop" value="#{dashboardManagedBean.salesDate}"  maxdate="#{dashboardManagedBean.currentDate}" />
                                <p:outputLabel style="color:white;" for="toDateTop" value="To" />
                                <p:calendar id="toDateTop"  value="#{dashboardManagedBean.salesDate}"  maxdate="#{dashboardManagedBean.currentDate}" />
                                <p:commandButton  update="msgsTopSales" actionListener="#{dashboardManagedBean.click}" icon="ui-icon-search" />
                            </h:panelGrid>

                        </h:form>

                    </div>

                    <div>

                        <h:form id="topForm">
                            <p:growl id="topMsg" showDetail="true" />
                            <h:panelGrid columns="2" cellpadding="5">

                                <p:outputLabel for="rankFilter" style="color:white;" value="Rank By: " />
                                <p:selectOneMenu id="rankFilter" value="haha" style="width:150px">
                                    <f:selectItems value="#{dashboardManagedBean.totalSalesByTeamFilter}" />
                                </p:selectOneMenu>
                            </h:panelGrid>


                        </h:form>
                    </div>

                    <div style="margin-top: 25px;">

                        <p:dataTable id="basicDT" var="product" value="#{dashboardManagedBean.products}">
                            <f:facet name="header">
                                Top 10 Customer
                            </f:facet>
                            <p:column headerText="Id">
                                <h:outputText value="#{product.id}" />
                            </p:column>
                            <p:column headerText="Team Name">
                                <h:outputText styleClass="topCustomerDiv"  value="#{product.team}" />
                            </p:column>
                            <p:column headerText="Country">
                                <h:outputText styleClass="topCustomerDiv"  value="#{product.country}" />
                            </p:column>
                            <p:column headerText="Price($)">
                                <h:outputText styleClass="topCustomerDiv"  value="#{product.price}" />
                            </p:column>
                            <p:column style="width:32px;text-align: center">
                                <p:commandButton update="#{p:component('formViewCustomer')}" oncomplete="PF('customerDialog').show()" icon="ui-icon-search" title="View">
                                    <f:setPropertyActionListener value="#{product}" target="#{dashboardManagedBean.selectedProducts}" />
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>

                    </div>


                    <h:form id="formViewCustomer">

                        <p:dialog id="customerDialog" appendTo="@(body)" widgetVar="customerDialog" header="Customer Profile" modal="true" height="250" width="450" closable="true" resizable="false">
                            <p:outputPanel id="carDetail" style="text-align:center;">
                                <p:panelGrid  columns="2" rendered="#{not empty dashboardManagedBean.selectedProducts}" columnClasses="label,value">

                                    <h:outputText value="Id:" />
                                    <h:outputText value="#{dashboardManagedBean.selectedProducts.id}" />

                                    <h:outputText value="Test 1" />
                                    <h:outputText value="#{dashboardManagedBean.selectedProducts.productCode}" />

                                </p:panelGrid>
                            </p:outputPanel>
                        </p:dialog>
                    </h:form>



                </p:tab>



            </p:tabView>

        </h:form>

    </ui:define>

</ui:composition>
