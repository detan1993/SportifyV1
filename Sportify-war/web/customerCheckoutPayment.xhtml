<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./template/masterPage.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:define name="center">
        <h:outputStylesheet library="css" name="checkoutPaymentStyle.css" />
        <h1 style="text-align: center; color: white; font-size: 30px">Checkout</h1>
        <div id="left" align="left" style="margin-left: 150px">
            <h:form prependId="false" style="background-color: #191919" id="editForm">
                <p:growl id="msgs" showDetail="true" />
                <p:accordionPanel>
                    <p:tab disabled="true" title="1. Shipping Address">

                        <p:panelGrid  layout="grid" columns="1">
                         
                            <p:commandLink id="ajaxoutput" process="@form" update="paymentform:paymentAccordion,ajaxoutput,confirm,edit,proceedpayment" action="#{customerCheckOutManagedBean.confirmAddress}">
                            <h:outputText style="color:aqua;width:200px;white-space: nowrap" value="#{customerCheckOutManagedBean.addrbtnval}" /></p:commandLink> 
                        <p:panel toggleable="true" id="edit" visible="#{customerCheckOutManagedBean.displayedit}">
                            <table style="font-size: 15px; border-collapse: seperate; border-spacing: 1em">
                                <tr><td><p:inputText  value="#{customerCheckOutManagedBean.loggedincustomer.firstName}" id="firstname" requiredMessage="Please enter your first name!" required="true" style="height:30px" placeholder="First Name"/></td><td> <p:inputText value="#{customerCheckOutManagedBean.loggedincustomer.lastName}" id="lastname" requiredMessage="Please enter your last name!" required="true" style="height:30px" placeholder="Last Name"/></td></tr>
                                <tr><td colspan="2"><p:inputText value="#{customerCheckOutManagedBean.loggedincustomer.address}" id="address" requiredMessage="Please enter an address!" required="true" style="width:380px ;height:30px" placeholder="Address"/></td></tr>           
                                <tr><td><p:inputText id="postalcode" value="#{customerCheckOutManagedBean.loggedincustomer.zipCode}" requiredMessage="Please enter your postal code" required="true" style="height:30px" placeholder="Postal Code"/></td><td><p:inputText id="phone" value="#{customerCheckOutManagedBean.loggedincustomer.phoneNum}" requiredMessage="Please enter your phone number!" required="true" style="height:30px" placeholder="Phone Number"/></td></tr>
                                <tr><td><p:inputText readonly="true" value="#{customerCheckOutManagedBean.loggedincustomer.email}" id="email" requiredMessage="Please enter your email!" required="true" style="height:30px; opacity: .7" placeholder="Email"/></td></tr>       
                            </table>               
                        </p:panel>
                             
                        <p:panel toggleable="true" id="confirm" style="width: 600px" visible="#{customerCheckOutManagedBean.displayconfirm}">
                            <table style="font-size: 15px; border-collapse: seperate; border-spacing: 1em">
                                <tr><td><h:outputLabel style="font-weight: bolder" value="First name: "></h:outputLabel></td><td><h:outputLabel value="#{customerCheckOutManagedBean.loggedincustomer.firstName}" id="firstnameoutput" style="height:30px; margin-left: 20px"/></td></tr>
                                <tr><td><h:outputLabel style="font-weight: bolder" value="Last Name:"/></td><td> <h:outputLabel value="#{customerCheckOutManagedBean.loggedincustomer.lastName}" id="lastnameoutput" style="height:30px; margin-left: 20px"/></td></tr>
                                <tr><td><h:outputLabel style="font-weight: bolder" value="Address: "/></td><td colspan="2"><h:outputLabel value="#{customerCheckOutManagedBean.loggedincustomer.address}" id="addressoutput" style="width: 367px; height:30px;  margin-left: 20px"/></td></tr>           
                                <tr><td><h:outputLabel style="font-weight: bolder" value="Postal code: "/></td><td><h:outputLabel id="postalcodeoutput" value="#{customerCheckOutManagedBean.loggedincustomer.zipCode}" style="height:30px;  margin-left: 20px"/></td></tr>
                                <tr><td><h:outputLabel style="font-weight: bolder" value="Contact No:"/></td><td><h:outputLabel id="phoneoutput"  value="#{customerCheckOutManagedBean.loggedincustomer.phoneNum}" style="height:30px;  margin-left: 20px"/></td></tr>
                                <tr><td><h:outputLabel style="font-weight: bolder" value="Email: "/></td><td><h:outputLabel value="#{customerCheckOutManagedBean.loggedincustomer.email}" id="emailoutput" style="height:30px; margin-left: 20px"/></td></tr>
                                <tr><td></td></tr>
                            </table>
                        </p:panel>
                          
                        </p:panelGrid>
                                            
                        <p:panel id="proceedpayment" visible="#{customerCheckOutManagedBean.displayconfirm}">
                            <p:remoteCommand name="rc" process="@this" update="paymentform:paymentAccordion,proceedpayment" actionListener="#{customerCheckOutManagedBean.proceedPayment}"/>
                            <h:commandButton type="button" onclick="rc()" value="Proceed to payment" class="checkoutBtn"></h:commandButton>
                        </p:panel>                    

                    </p:tab> 
                </p:accordionPanel>
            </h:form>
            <h:form style="margin-top: 20px; background-color: #191919" id="paymentform">
                <p:accordionPanel id="paymentAccordion"  activeIndex="#{customerCheckOutManagedBean.activetab}">
                    <p:tab disabled="true" title="2. Payment Details">        
                        <p:panel id="paymetinfo">
                            <table style="border-collapse: seperate; border-spacing: 1em">
                                <tr><h1 style="color: white; width: 400px">We accept: </h1></tr>
                                <tr><td><h:graphicImage height="50px" width="50px" name="images/master.png" /></td>
                                    <td><h:graphicImage height="50px" width="50px" name="images/visa.png" /></td>
                                </tr>
                                <tr>
                                    <td colspan="2"><p:inputText requiredMessage="Please enter your card number!" required="true" style="height:30px; width:376px" placeholder="Card Number"/></td>
                                </tr>

                                <tr><td><p:inputText style="height:30px" requiredMessage="Please enter your expiry date!" required="true" placeholder="MM/YY"></p:inputText></td>
                                    <td><p:inputText style="height:30px" requiredMessage="Please enter your security code!" required="true" placeholder="XXX"></p:inputText></td>
                                </tr>

                            </table> 
                        </p:panel>           

                        <h:panelGrid id="togglegrid" columns="2" style="width: 250px;margin-bottom:10px" cellpadding="5">
                            <p:selectBooleanCheckbox value="#{customerCheckOutManagedBean.samebillingaddr}">
                                <p:ajax update="billingsame,editbilling" listener="#{customerCheckOutManagedBean.toggleBillingAddress}" />
                            </p:selectBooleanCheckbox>
                            <h:outputText  value="Billing address same as shipping" />
                        </h:panelGrid>
                        <p:panel id="billingsame" style="width:600px" visible="#{customerCheckOutManagedBean.samebillingaddr}">
                            <table style="font-size: 15px; border-collapse: seperate; border-spacing: 1em">
                                <tr><td><h:outputLabel style="font-weight: bolder" value="First name: "></h:outputLabel></td><td><h:outputLabel value="#{customerCheckOutManagedBean.loggedincustomer.firstName}" id="firstnamebilling" style="height:30px; margin-left: 20px"/></td></tr>
                                <tr><td><h:outputLabel style="font-weight: bolder" value="Last Name:"/></td><td> <h:outputLabel value="#{customerCheckOutManagedBean.loggedincustomer.lastName}" id="lastnamebilling" style="height:30px; margin-left: 20px"/></td></tr>
                                <tr><td><h:outputLabel style="font-weight: bolder" value="Address: "/></td><td colspan="2"><h:outputLabel value="#{customerCheckOutManagedBean.loggedincustomer.address}" id="addressbilling" style="width: 367px; height:30px;  margin-left: 20px"/></td></tr>           
                                <tr><td><h:outputLabel style="font-weight: bolder" value="Postal code: "/></td><td><h:outputLabel id="postalcodebilling" value="#{customerCheckOutManagedBean.loggedincustomer.zipCode}" style="height:30px;  margin-left: 20px"/></td></tr>
                            </table>
                        </p:panel>

                        <p:panel id="editbilling" style="width: 600px" visible="#{customerCheckOutManagedBean.showsamebillingaddr}" >
                            <table style="font-size: 15px; border-collapse: seperate; border-spacing: 1em">
                                <tr><td><p:inputText  value="#{customerCheckOutManagedBean.loggedincustomer.firstName}" id="firstnameeditbill" requiredMessage="Please enter your first name!" required="true" style="height:30px" placeholder="First Name"/></td><td> <p:inputText value="#{customerCheckOutManagedBean.loggedincustomer.lastName}" id="lastnameeditbill" requiredMessage="Please enter your last name!" required="true" style="height:30px" placeholder="Last Name"/></td></tr>
                                <tr><td colspan="2"><p:inputText value="#{customerCheckOutManagedBean.loggedincustomer.address}" id="addresseditbill" requiredMessage="Please enter an address!" required="true" style="width: 380px; height:30px" placeholder="Address"/></td></tr>           
                                <tr><td><p:inputText id="postalcodeeditbill" value="#{customerCheckOutManagedBean.loggedincustomer.zipCode}" requiredMessage="Please enter your postal code" required="true" style="height:30px" placeholder="Postal Code"/></td></tr>            
                            </table>    
                        </p:panel>  


                        <h:commandButton style="margin-bottom: -40px" value="Confirm Order" class="checkoutBtn" action="#{customerCheckOutManagedBean.makeOrder}"></h:commandButton>       
                    </p:tab>
                </p:accordionPanel>


            </h:form>
        </div>

        <div style="background-color: #191919; width: 350px; margin-right: 200px; float:right;">


            <p:fieldset legend="Summary" style="margin-bottom:20px; background-color: #191919;font-size: 20px">
                <h:panelGrid columns="2" cellpadding="5" style="font-size: 15px;">
                    <h:outputText value="Subtotal: " style="font-weight: bold"/>
                    <h:outputText value="$#{customerCheckOutManagedBean.subtotaldisplay}"/>

                    <h:outputText value="Estimated shipping: " style="font-weight: bold"/>
                    <h:outputText value="$5"/>

                    <h:outputText value="Total: " style="font-weight: bold"/>
                    <h:outputText value="$#{customerCheckOutManagedBean.totaldisplay}"/>
                </h:panelGrid>
            </p:fieldset>

            <p:fieldset legend="In your cart" style="margin-bottom:10px;font-size: 20px">
                <p:dataGrid value="#{customerCheckOutManagedBean.cartitems}" var="cartitem" columns="1">
                    <h:panelGrid styleClass="panelGrid" columns="2" style="width:150%;font-size: 15px" columnClasses="logo,detail">
                        <p:graphicImage style="height:50px; width: 50px; margin-bottom: 70px" name="#{cartitem[6]}"/>
                        <p:outputPanel>
                            <h:panelGrid columns="2" cellpadding="5">
                                <h:outputText value="Product:" style="font-weight: bold"/>
                                <h:outputText value="#{cartitem[3]}"></h:outputText>

                                <h:outputText value="Size:" style="font-weight: bold"/>
                                <h:outputText value="#{cartitem[1]}"></h:outputText>

                                <h:outputText value="Qty" style="font-weight: bold"/>
                                <h:outputText value="#{cartitem[2]}"></h:outputText>

                                <h:outputText value="Product code:" style="font-weight: bold" />
                                <h:outputText value="#{cartitem[4]}"></h:outputText>

                                <h:outputText value="$#{cartitem[5]}" style="font-weight: bold"></h:outputText>
                            </h:panelGrid>
                        </p:outputPanel>
                    </h:panelGrid>

                </p:dataGrid>
            </p:fieldset>
        </div>
        
    </ui:define>
</ui:composition>

